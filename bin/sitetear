#!/usr/bin/perl -w

use strict;
use File::Basename;
use File::Spec;
use Getopt::Long;
use Pod::Usage;

use HTML::SiteTear;

our $VERSION = '1.2.1';

{
	my $man = 0;
	my $help = 0;
	my $filter;
	
	GetOptions('help|?' => \$help, man => \$man,
				'F=s'=>\$filter) or pod2usage(2);
	pod2usage(-exitstatus => 0, -verbose => 1) if $help;
	pod2usage(-exitstatus => 0, -verbose => 2) if $man;

	if (@ARGV > 2) {
		pod2usage(-message => 'Too many arguments.', 
			  -exitstatus => 1, -verbose => 1)
	}

	if (@ARGV < 2) {
		pod2usage(-message => 'Required arguments is not given.', 
			  -exitstatus => 1, -verbose => 1)
	}

	my ($sourcePath, $targetPath) = @ARGV;

	my $siteTear = HTML::SiteTear->new($sourcePath);
	if ($filter) {
		$siteTear->setPageFilter($filter);
	}
	$siteTear->copyTo($targetPath);
}

1;

__END__

=head1 NAME

sitetear -- Make a separated copy form a part of a web site

=head1 SYNOPSIS

 sitetear [OPTION] SOURCE DESTINATION
 sitetear [OPTION] SOURCE DIRECTORY

=head1 DESCRIPTION

sitetear make a separated copy of a part of web site in local file system. All linked files (HTML file, image file, javascript, cascading style shieet) from a source HTML file will be copied under a new page.

This command is useful to make a destributable copy of a part of a web site.

=head1 OPTIONS

=over 4

=item -h, --help

Print a brief help message and exits.

=item -m, --man

Prints the manual page and exits.

=back

=head1 AUTHOR

Tetsuro KURITA <tkurita@mac.com>

=cut
